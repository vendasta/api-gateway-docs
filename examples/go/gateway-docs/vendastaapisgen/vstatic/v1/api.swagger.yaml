swagger: "2.0"
info:
  title: vstatic/v1/api.proto
  version: version not set
tags:
  - name: VStatic
consumes:
  - application/json
produces:
  - application/json
paths:
  /vstatic.v1.VStatic/CreateApplication:
    post:
      summary: Creates a new application, this should match either an existing AppEngine project or a k8s Âµservice.
      operationId: VStatic_CreateApplication
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateApplicationRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/CreateDeliveryStrategy:
    post:
      summary: A delivery strategy controls how a deployment of an application is hosted to the end user.
      operationId: VStatic_CreateDeliveryStrategy
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateDeliveryStrategyResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateDeliveryStrategyRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/CreateDeployment:
    post:
      summary: |-
        Creates a new deployment that is a child of an application. A deployment contains the artifacts of an
        application (App Bundles, CSS, etc...)
      operationId: VStatic_CreateDeployment
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateDeploymentResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateDeploymentRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/CreateStaticResource:
    post:
      summary: Creates a new static resource object
      operationId: VStatic_CreateStaticResource
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateStaticResourceRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/DeleteDeliveryStrategy:
    post:
      summary: Delete an existing delivery strategy
      operationId: VStatic_DeleteDeliveryStrategy
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1DeleteDeliveryStrategyRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/GetAssetURL:
    post:
      summary: Retrieves the serving url for the given application and asset
      operationId: VStatic_GetAssetURL
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetAssetURLResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1GetAssetURLRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/GetDeployments:
    post:
      summary: Get deployments for an application.
      operationId: VStatic_GetDeployments
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetDeploymentsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1GetDeploymentsRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/GetIndex:
    post:
      summary: Retrieves the index.html for the given application
      operationId: VStatic_GetIndex
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetIndexResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1GetIndexRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/ListApplications:
    post:
      summary: Lists a page of applications
      operationId: VStatic_ListApplications
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListApplicationsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1ListApplicationsRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/ListDeliveryStrategies:
    post:
      summary: Lists all of the active delivery strategies for an application
      operationId: VStatic_ListDeliveryStrategies
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListDeliveryStrategiesResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1ListDeliveryStrategiesRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/ListDeployments:
    post:
      summary: List deployments for an application in created order descenging.
      operationId: VStatic_ListDeployments
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListDeploymentsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1ListDeploymentsRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/UpdateApplication:
    post:
      summary: Updates an application
      operationId: VStatic_UpdateApplication
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateApplicationRequest'
      tags:
        - VStatic
  /vstatic.v1.VStatic/UpdateDeliveryStrategy:
    post:
      summary: Updates the delivery strategy to a new deployment
      operationId: VStatic_UpdateDeliveryStrategy
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1UpdateDeliveryStrategyRequest'
      tags:
        - VStatic
definitions:
  DeliveryStrategyDelivery:
    type: object
    properties:
      deploymentId:
        type: string
        title: The deployment this delivery is for
      deliveryTime:
        type: string
        format: date-time
        title: The time this delivery occured
      userEmail:
        type: string
        title: The email of the user who created this delivery
  GetDeploymentsResponseDeploymentContainer:
    type: object
    properties:
      deployment:
        $ref: '#/definitions/v1Deployment'
  IAMFilter:
    type: object
    properties:
      filters:
        type: object
        additionalProperties:
          type: string
  StrategyDefault:
    type: object
    title: Default sets the default deploy strategy
  StrategyIAM:
    type: object
    properties:
      attributeFilters:
        $ref: '#/definitions/IAMFilter'
        description: Attribute filter allows a version to select specific IAM users to receive this deployment.
    title: IAM deploy strategy
  StrategyPercentage:
    type: object
    properties:
      percentage:
        type: string
        format: int64
    description: Allows a delivery strategy to limit the percentage of users that receive the deployment.
  protobufAny:
    type: object
    properties:
      '@type':
        type: string
    additionalProperties: {}
  rpcStatus:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      details:
        type: array
        items:
          type: object
          $ref: '#/definitions/protobufAny'
  v1Application:
    type: object
    properties:
      appId:
        type: string
        title: 'unique identifier for the application (example: partner-center-client)'
      appName:
        type: string
        title: 'human readable name for the application (example: Partner Center Client)'
      githubRepoUrl:
        type: string
        title: 'The Github Repository URL (example: https://github.com/vendasta/IAM)'
      entryUrlTemplate:
        type: string
        description: |-
          A entry url to the application which contains the string <deployment>.
          This will be used to create a deployment view link in mission control,
          and <deployment> will be replaced with the specific deployment id.
    title: |-
      Application represents a piece of software that can have only a single delivered artifact at any given time.
      For example: the Partner Center has a single vStatic application called `partner-center-client`
  v1Artifacts:
    type: object
    properties:
      gcsBucket:
        type: string
    title: Code artifacts used for an application deployment
  v1CreateApplicationRequest:
    type: object
    properties:
      application:
        $ref: '#/definitions/v1Application'
    title: Request message for vStatic.CreateApplication
  v1CreateDeliveryStrategyRequest:
    type: object
    properties:
      appId:
        type: string
        title: The application ID
      deploymentId:
        type: string
        title: The deployment ID to deliver
      environment:
        $ref: '#/definitions/v1Environment'
        description: The environment to create the delivery strategy for.
      strategy:
        $ref: '#/definitions/v1Strategy'
        title: The strategy to use for the delivery
      name:
        type: string
        title: The name of the delivery (Can not be specified if the delivery is the default)
    title: Request message for vStatic.CreateDeliveryStrategy
  v1CreateDeliveryStrategyResponse:
    type: object
    properties:
      deliveryStrategyId:
        type: string
        title: The ID of the delivery strategy
    title: Response message for vStatic.CreateDeliveryStrategy
  v1CreateDeploymentRequest:
    type: object
    properties:
      deployment:
        $ref: '#/definitions/v1Deployment'
    title: Request message for vStatic.CreateDeployment
  v1CreateDeploymentResponse:
    type: object
    properties:
      deploymentId:
        type: string
        title: The unique identifier for the created deployment
    title: Response message for vStatic.CreateDeployment
  v1CreateStaticResourceRequest:
    type: object
    properties:
      mediarepoId:
        type: string
    title: Request message for vStatic.CreateStaticResource
  v1DeleteDeliveryStrategyRequest:
    type: object
    properties:
      appId:
        type: string
      deliveryId:
        type: string
      environment:
        $ref: '#/definitions/v1Environment'
        title: Environment that this delivery strategy is for
    title: Request message for vStatic.DeleteDeliveryStrategy
  v1DeliveryStrategy:
    type: object
    properties:
      deliveryStrategyId:
        type: string
        title: The unique id for the delivery strategy
      strategy:
        $ref: '#/definitions/v1Strategy'
        title: the strategy being used
      deploymentId:
        type: string
        title: the deployment being used for this delivery
      environment:
        $ref: '#/definitions/v1Environment'
        description: The environment this delivery strategy is active for.
      created:
        type: string
        format: date-time
        title: The date the delivery strategy was created
      updated:
        type: string
        format: date-time
        title: The date the delivery strategy was last updated
      deliveryHistory:
        type: array
        items:
          type: object
          $ref: '#/definitions/DeliveryStrategyDelivery'
        title: The history of deliveries for this strategy, limited to the last 15
    title: The delivery strategy is an active delivery strategy of a deployment for an application
  v1Deployment:
    type: object
    properties:
      appId:
        type: string
        title: The application ID
      deploymentId:
        type: string
        title: (Ouput Only) The ID of the deployment
      gitHash:
        type: string
        title: if applicable, the git hash of this deployment
      artifacts:
        $ref: '#/definitions/v1Artifacts'
        description: The arficacts to be served for this application.
      environment:
        $ref: '#/definitions/v1Environment'
        description: Environment to scope this deployment to.
      created:
        type: string
        format: date-time
        title: Output only - Time the deployment was created
      updated:
        type: string
        format: date-time
        title: Output only - Time the deployment was last updated
      containerBuilderId:
        type: string
        title: Optional - Google Container Builder ID that built and published this deployment
      gitCommitDetails:
        $ref: '#/definitions/v1GitCommitDetails'
        description: Deprecated - no longer populated. Use mission control's deployment model for this info.
      author:
        type: string
        title: Output only - The creator of the deployment
      name:
        type: string
        description: If deploying a custom artifact, a name is required.
      branchName:
        type: string
        title: if applicable, the git branch name of this deployment
    description: Deployment represents an immutable artifact that can be delivered to the end user.
  v1Environment:
    type: string
    enum:
      - Test
      - Demo
      - Prod
      - All
    default: Test
    description: Environment represents a vStatic environment that segments an application into test, demo, and production deliveries.
  v1GetAssetURLRequest:
    type: object
    properties:
      appId:
        type: string
        title: Retrieves this applications assets url
      environment:
        $ref: '#/definitions/v1Environment'
      deploymentId:
        type: string
        title: The id of the deployment of the index file that has already been served to the user
      assetPath:
        type: string
        title: The path to the asset (no hostname) i.e. /assets/images/logo.png
    title: Request message for vStatic.GetAssetURL
  v1GetAssetURLResponse:
    type: object
    properties:
      servingUrl:
        type: string
        title: the combination of the hostname and asset path of where the asset is being served from
    title: Response message for vStatic.GetAssetURL
  v1GetDeploymentsRequest:
    type: object
    properties:
      applicationId:
        type: string
        title: The unique identifier of the application
      environment:
        $ref: '#/definitions/v1Environment'
        title: The environment to scope the deployments to
      deploymentIds:
        type: array
        items:
          type: string
        title: The IDs of the deployments to get
  v1GetDeploymentsResponse:
    type: object
    properties:
      deployments:
        type: array
        items:
          type: object
          $ref: '#/definitions/GetDeploymentsResponseDeploymentContainer'
        title: The list of requested Deployment
  v1GetIndexRequest:
    type: object
    properties:
      appId:
        type: string
        title: Retrieves this applications index.html
      environment:
        $ref: '#/definitions/v1Environment'
      iamToken:
        type: string
        title: 'Optional: If provided, will run this request through the active delivery strategies'
      deploymentId:
        type: string
        description: 'Optional: Will override the delivery strategies for the application and will use this deployments artifacts, if the deployment belongs to application.'
      localeId:
        type: string
        title: 'Optional: Defaults to en(english), if no index.html exists for provided locale the english version will be returned'
      subdirectory:
        type: string
        title: 'Optional: If provided, will look for index.html in a subdirectory of the deployment''s GCS bucket'
      partnerId:
        type: string
        description: 'Optional: If provided, will stamp down partner id into index.html. Requires `<!-- vStaticInject:partnerId -->` in index.html.'
    title: Request message for vStatic.GetIndex
  v1GetIndexResponse:
    type: object
    properties:
      html:
        type: string
        format: byte
      deploymentId:
        type: string
        description: The id of this deployment, if you supplied one in the request it will be the same.
    title: Response message for vStatic.GetIndex
  v1GitCommitDetails:
    type: object
    properties:
      author:
        $ref: '#/definitions/v1GithubCommitUser'
        title: The user who created the content
      committer:
        $ref: '#/definitions/v1GithubCommitUser'
        title: The user who committed the content
      message:
        type: string
        title: the content of the git commit message
    title: The details of the git commit (if any)
  v1GithubCommitUser:
    type: object
    properties:
      date:
        type: string
        format: date-time
      name:
        type: string
      email:
        type: string
    description: Details about the user who committed/authored a specific git commit.
  v1ListApplicationsRequest:
    type: object
    properties:
      pagingOptions:
        $ref: '#/definitions/v1PagedRequestOptions'
    title: Request message for vStatic.ListApplicationsRequest
  v1ListApplicationsResponse:
    type: object
    properties:
      applications:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1Application'
      pagingMetadata:
        $ref: '#/definitions/v1PagedResponseMetadata'
    title: Response message for vStatic.ListApplications
  v1ListDeliveryStrategiesRequest:
    type: object
    properties:
      appId:
        type: string
        title: The application ID
      environment:
        $ref: '#/definitions/v1Environment'
        title: The environment to get
    title: Request message for vStatic.ListDeliveryStrategies
  v1ListDeliveryStrategiesResponse:
    type: object
    properties:
      strategies:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1DeliveryStrategy'
    title: Response message for vStatic.ListDeliveryStrategiesResponse
  v1ListDeploymentsRequest:
    type: object
    properties:
      applicationId:
        type: string
        title: The unique identifier of the application
      environment:
        $ref: '#/definitions/v1Environment'
        title: The environment to scope the deployments to
      pagingOptions:
        $ref: '#/definitions/v1PagedRequestOptions'
    title: Request message for vStatic.ListDeployments
  v1ListDeploymentsResponse:
    type: object
    properties:
      deployments:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1Deployment'
      pagingMetadata:
        $ref: '#/definitions/v1PagedResponseMetadata'
    title: Response message for vStatic.ListDeployments
  v1PagedRequestOptions:
    type: object
    properties:
      cursor:
        type: string
        title: cursor can be passed to retrieve the next page of results keyed by the cursor
      pageSize:
        type: string
        format: int64
        title: page_size specifies the number of items to return in the next page
    description: Metadata for paging through a list/search endpoint.
  v1PagedResponseMetadata:
    type: object
    properties:
      nextCursor:
        type: string
        title: A cursor that can be provided to retrieve the next page of results
      hasMore:
        type: boolean
        title: Whether or not more results exist
    description: Metadata for paging through a list/search endpoint.
  v1Strategy:
    type: object
    properties:
      default:
        $ref: '#/definitions/StrategyDefault'
      iam:
        $ref: '#/definitions/StrategyIAM'
      percentage:
        $ref: '#/definitions/StrategyPercentage'
    description: Strategy controls the delivery mechanism for a specific deployment to the end user.
  v1UpdateDeliveryStrategyRequest:
    type: object
    properties:
      appId:
        type: string
        title: The application ID
      deliveryStrategyId:
        type: string
        title: The delivery strategy being updated
      deploymentId:
        type: string
        title: Updates the delivery strategy
      environment:
        $ref: '#/definitions/v1Environment'
        description: Environment to scope this delivery strategy to.
    title: Request message for vStatic.UpdateDeliveryStrategyRequest
